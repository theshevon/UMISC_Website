<% include ./partials/header-top %>

<title>umisc | blog</title>

<% include ./partials/header-bottom %>

<!-- Custom CSS -->
<link rel="stylesheet" href="/stylesheets/blog.css">

<!-- Section Classes -->
<% var classes = ["col-12", "col-12 col-md-5", "col-12 col-md-7", "col-12 col-md-7", "col-12 col-md-5"]; %>

<div id="content">
    
    <% if (posts.length === 0 ){ %>
        <h2 id="sorry-msg">Sorry, no Blog Posts have been published yet.</h2>
    <% }else{ %>
        <% var postCount = 0 %>
        <section id="blog-posts">
        <% posts.forEach(function(post){ %>
            <div class="b-post <%= classes[postCount] %>">
                    <% if (post.content.indexOf("<figure>") !== -1 ){ %>
                    <img src="<%= getImgSrc(post.content) %>" class="img-fluid" alt="">
                    <% }else { %>
                    <img src="./images/stub.jpg" class="img-fluid" alt="">
                    <% } %>
                    <div class="container info">
                        <h3><%=post.title%></h3>
                        <p><%=post.contentSnippet%><a href="<%= post.link %>" target="_blank">See More</a></p>
                    </div>
                <% postCount++ %>
                <% if (postCount === 5) postCount = 0 %>
            </div>
        <% }); %>
        </section>
    <% } %>

    <% 
        function getImgSrc(str){                 
            var index = str.indexOf("src") + 5; 
            var imgSrc = "";                    
            while (str[index] !== "\""){        
                imgSrc += str[index];           
                index ++;                       
            }                                   
            return imgSrc;                      
        }                
    %>
   


</div>

<% include ./partials/footer %>
